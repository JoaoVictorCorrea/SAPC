<html>
	<head th:replace="~{base :: head}"></head>
	<body id="body-pd">
	    <div th:replace="~{base :: header}"></div>
	    <div th:replace="~{base :: sidebar}"></div>
	    
	   <section class="wrapper">
	       	<div class="row">
	            <div class="col-lg-12">
	                <h3 class="pb-2 mt-4 mb-2 border-bottom">Parâmetros</h3>
	                <nav aria-label="breadcrumb">
		                <ol class="breadcrumb">
		                    <li class="breadcrumb-item"><a class="black" th:href="@{/home}">Home</a></li>
		                    <li class="breadcrumb-item" aria-current="page">Moradores</li>
		                </ol>
		          	</nav>
	            </div>
        	</div>
		    <div class="row">
		        <div class="col-lg-12">
		            <section class="card mb-3">
		                
		                <div class="d-flex justify-content-between card-footer">
		                	<h3 class="pt-3">Moradores</h3>
	                        <form th:action="@{/parameters/countries}" class="d-flex mt-3" >
	                            <div class="pe-3">
	                                <input type="text" name="keyword" class="form-control">
	                            </div>
	                            <div class="col-4">
	                                <input type="submit" value="Filtrar" class="btn-success form-control">
	                            </div>
	                        </form>
		               	</div>
		                    
		            </section>
		    	</div>
		    </div>
            <section class="card">

                <table id="tabela" class="table table-striped table-advance table-hover">
                    <tbody>
                    <tr>
                        <th></th>
                        <th><i class="bx bx-user-circle"></i> <a th:href="@{'/morador/page/' + ${currentPage} + '/nome?sortDir=' + ${reverseSortDir}}">Nome</a></th>
                        <th><i class="bx bx-envelope"></i> <a th:href="@{/morador/page/{pageNumber}/{field}(pageNumber=${currentPage}, field='email')} + '?sortDir=' + ${reverseSortDir}">Email</a></th>
                        
                        <th><i class="bx bx-phone"></i> <a th:href="@{/morador/page/{pageNumber}/{field}(pageNumber=${currentPage}, field='telefone')} + '?sortDir=' + ${reverseSortDir}">Telefone</a></th>
                        <th><i class="bx bx-home-alt-2"></i> <a th:href="@{'/morador/page/' + ${currentPage} + '/residencia?sortDir=' + ${reverseSortDir}}">Número da Residência</a></th>
                        <th><i class="bx bx-building"></i> <a th:href="@{'/morador/page/' + ${currentPage} + '/bloco?sortDir=' + ${reverseSortDir}}">Bloco</a></th>
                        <th><i class="bx bx-search"></i><a href="">Ações</a></th>
                    </tr>
                    <tr th:each="morador:${listMoradores}">
                        <td></td>
                        <td th:text="${morador.nome}"></td>
                        <td th:text="${morador.email}"></td>
                        <td th:text="${morador.telefone}"></td>
                        <td th:text="${morador.residencia.numero}"></td>
                        <td th:text="${morador.residencia.bloco}"></td>
                        <td class="text-center">
                            <div class="btn-group">
                            
                                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#updateModal">
                                	<i class="bx bx-refresh"></i>
                                </button>
                                
<!--                                 th:href="@{'/morador/editar/'+${morador.id}}" -->
                                
                                <!-- Update Modal -->
								<div class="modal fade" id="updateModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
								  <div class="modal-dialog">
								    <div class="modal-content">
								      <div class="modal-header">
								        <h5 class="modal-title" id="exampleModalLabel">Atualizar morador</h5>
								        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
								      </div>
								      <div class="modal-body fs-5">
								      	<form th:action="@{'/morador/update/' + ${morador.id}}" method="post">
								      		<input type="hidden" th:value="${morador.id}"/>
									    	<div class="row mb-3">
										    	<div class="col-md-6">
										         	<label for="nome">Nome completo</label>
										        	<input type="text" class="form-control" id="nome" th:value="${morador.nome}">
										      	</div>
										      	<div class="col-md-6">
										          	<label for="email">Email</label>
										          	<input type="email" class="form-control"id="email" th:value="${morador.email}">
										        </div>
										    </div>
									         <div class="row mb-3">
										    	<div class="col-md-6">
										        	<label for="company">CPF</label>
										          	<input type="text" class="form-control" name="cpf" id="cpf">
										      	</div>
										 		<div class="col-md-6"> 
											    	<label for="phone">Telefone</label>
											        <input type="tel" class="form-control" name="telefone" id="telefone">
										        </div>
										    </div>
									    </form>
								      </div>
								      <div class="modal-footer">
								        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
								        <a th:href="@{'/morador/deletar/' + ${morador.id}}" class="btn btn-success">Sim</a>
								      </div>
								    </div>
								  </div>
								</div>
                                
                                <a class="btn btn-success" href="#"><i class="bx bx-phone-call"></i></a>
                                
								<button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#exampleModal">
								    <i class="bx bx-trash"></i>
								</button>
								
								 <!-- Delete Modal -->
								<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
								  <div class="modal-dialog">
								    <div class="modal-content">
								      <div class="modal-header bg-danger text-light">
								        <h5 class="modal-title" id="exampleModalLabel">Deletar morador</h5>
								        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
								      </div>
								      <div class="modal-body fs-5">
								        Deseja realmente deletar esse morador?
								      </div>
								      <div class="modal-footer">
								        <button type="button" class="btn btn-success" data-bs-dismiss="modal">Fechar</button>
								        <a th:href="@{'/morador/deletar/' + ${morador.id}}" class="btn btn-danger">Sim</a>
								      </div>
								    </div>
								  </div>
								</div>
								
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>

                <footer class="card-footer d-flex justify-content-between">
                    
                    <nav aria-label="Page navigation example">
                    	Total de itens [[${totalItems}]] : Página [[${currentPage}]] de [[${totalPages}]]
	                    <ul class="pagination">
	                    	<li class="page-item">
                                <a class="page-link" th:if="${currentPage > 1}" th:href="${sortDir != null and field != null}
	                                ? @{/morador/page/1/{field}(field=${field},sortDir=${sortDir != null ? sortDir : reverseSortDir})}
	                                : @{/morador/page/1}">
	                                Primeira
                                </a>
                                <span class="page-link" th:unless="${currentPage > 1}">Primeira</span>
	                    	</li>
   						 	<li class="page-item">
   						 		<a class="page-link" th:if="${currentPage > 1}" th:href="${sortDir != null and field != null}
	   						 		? @{/morador/page/{pageNumber}/{field}(pageNumber=${currentPage - 1},field=${field},sortDir=${sortDir != null ? sortDir : reverseSortDir})}
	   						 		: @{'/morador/page/' + ${currentPage - 1}}">
	   						 		Anterior
   						 		</a>
                                <span class="page-link" th:unless="${currentPage > 1}">Anterior</span>
   						 	</li>
	                    	<li class="page-item d-flex">
	                    		<span th:each="i: ${#numbers.sequence(1, totalPages)}">
                                     <a class="page-link" th:href="${sortDir != null and field != null}
										? @{/morador/page/{pageNumber}/{field}(pageNumber=${i},field=${field},sortDir=${sortDir != null ? sortDir : reverseSortDir})}
										: @{/morador/page/{pageNumber}(pageNumber=${i})}">
										[[${i}]]
									</a>
                                </span>
                            </li>
						    <li class="page-item">
						    	<a class="page-link" th:if="${currentPage < totalPages}" th:href="${sortDir != null and field != null}
						    		? @{/morador/page/{pageNumber}/{field}(pageNumber=${currentPage + 1},field=${field},sortDir=${sortDir != null ? sortDir : reverseSortDir})}
						    		: @{'/morador/page/' + ${currentPage + 1}}">
						    		Próximo
						    	</a>
                                <span class="page-link" th:unless="${currentPage < totalPages}">Próximo</span>
						    </li>
						    <li class="page-item">
						    	<a class="page-link" th:if="${currentPage < totalPages}" th:href="${sortDir != null and field != null}
							    	? @{/morador/page/{pageNumber}/{field}(pageNumber=${totalPages},field=${field},sortDir=${sortDir != null ? sortDir : reverseSortDir})}
							    	: @{'/morador/page/' + ${totalPages}}">
							    	Ultima
						    	</a>
                                <span class="page-link" th:unless="${currentPage < totalPages}">Ultima</span>
						    </li>
	                    									
	                    </ul>
	               	</nav>

					<div> 
<!-- 						<button class="btn btn-gold mt-2" type="submit" id="btnAdicionarMorador" href="/morador/adicionar">Adicionar Morador</button> -->
                       <a id="btnAdicionarMorador" class="btn btn-gold mt-2">
                           Adicionar Novo Morador
                       </a>
		        	</div>
		               	
                </footer>
            </section>
    <!--Content of the page-->
    </section>
    
   
                                
	    <script th:replace="~{base :: sidebar-script}"></script>
	    <script>
	    
	    
	    $('#busca').on('keyup', function() {
	    	  var termo = $(this).val().toLowerCase();
	    	  
	    	  $('#tabela tbody tr').each(function() {
	    	    var linha = $(this);
	    	    
	    	    // Verificar se o termo de busca existe em algum dos campos da linha
	    	    if (linha.text().toLowerCase().indexOf(termo) === -1) {
	    	      linha.hide(); // Esconder a linha se não for encontrada
	    	    } else {
	    	      linha.show(); // Mostrar a linha se for encontrada
	    	    }
	    	  });
	    });
	    
	    $("#btnAdicionarMorador").on("click", function(){
	    	window.location.href = "/morador/adicionar";
	    })

	    </script>
	</body>
</html>